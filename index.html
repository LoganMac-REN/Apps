<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Grocery List (React)</title>
  <style>
    :root{ --bg:#fafafa; --card:#fff; --text:#111; --muted:#6b7280; --border:#e5e7eb; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;background:var(--bg);color:var(--text)}
    .wrap{max-width:680px;margin:0 auto;padding:16px}
    header{display:flex;align-items:baseline;justify-content:space-between;gap:8px;margin:4px 0 12px}
    h1{font-size:22px;margin:0}
    .muted{color:var(--muted);font-size:12px}
    .controls{display:flex;gap:8px;flex-wrap:wrap;margin:8px 0 12px}
    button,input[type="text"]{border:1px solid var(--border);border-radius:12px;background:var(--card);padding:10px 12px;font-size:16px}
    button{cursor:pointer} button:active{transform:scale(.98)}
    input[type="text"]{flex:1;min-width:160px}
    .chip{border-radius:999px;padding:6px 10px;font-size:13px}
    section{margin-bottom:12px}
    h2{font-size:12px;letter-spacing:.06em;text-transform:uppercase;color:var(--muted);margin:10px 2px}
    ul{list-style:none;padding:0;margin:0}
    li{display:flex;align-items:center;gap:10px;background:var(--card);border:1px solid var(--border);border-radius:14px;padding:12px;margin-bottom:8px}
    input[type="checkbox"]{width:22px;height:22px}
    .item-text{flex:1;font-size:16px}
    .done{color:#9ca3af;text-decoration:line-through}
    .footer{margin-top:18px;font-size:12px;color:var(--muted)}
  </style>

  <!-- React + ReactDOM via CDN, and Babel so the browser can run JSX -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;
    const STORAGE_KEY = "groceryList_v1";

    const DEFAULT_ITEMS = [
      { id: "butter", text: "Unsalted butter (120 g)", checked: false, category: "Baking" },
      { id: "kinder", text: "Kinder Chocolate", checked: false, category: "Chocolate" },
      { id: "parchment", text: "Parchment paper", checked: false, category: "Supplies" },
      { id: "ziplock", text: "Small Ziplock bags", checked: false, category: "Supplies" },
    ];

    function App() {
      const [items, setItems] = useState(() => {
        try {
          const raw = localStorage.getItem(STORAGE_KEY);
          return raw ? JSON.parse(raw) : DEFAULT_ITEMS;
        } catch { return DEFAULT_ITEMS; }
      });
      const [newItem, setNewItem] = useState("");
      const [hideChecked, setHideChecked] = useState(false);

      useEffect(() => {
        try { localStorage.setItem(STORAGE_KEY, JSON.stringify(items)); } catch {}
      }, [items]);

      const addItem = () => {
        const t = newItem.trim();
        if (!t) return;
        setItems(prev => [...prev, { id: Date.now().toString(36), text: t, checked: false, category: "" }]);
        setNewItem("");
      };

      const toggleItem = id => setItems(prev => prev.map(i => i.id === id ? { ...i, checked: !i.checked } : i));
      const clearChecked = () => setItems(prev => prev.filter(i => !i.checked));
      const reset = () => setItems(DEFAULT_ITEMS);

      const remaining = items.filter(i => !i.checked).length;
      const displayed = hideChecked ? items.filter(i => !i.checked) : items;

      // group by category
      const groups = displayed.reduce((acc, item) => {
        const key = item.category || "Other";
        (acc[key] ||= []).push(item);
        return acc;
      }, {});

      return (
        <div className="wrap">
          <header>
            <h1>Grocery List</h1>
            <div className="muted">{items.length - remaining} checked • {remaining} to go</div>
          </header>

          <div className="controls">
            <input
              id="newItem"
              type="text"
              placeholder="Add an item…"
              value={newItem}
              onChange={e => setNewItem(e.target.value)}
              onKeyDown={e => e.key === "Enter" && addItem()}
            />
            <button onClick={addItem}>Add</button>
            <button className="chip" onClick={() => setHideChecked(v => !v)}>
              {hideChecked ? "Show checked" : "Hide checked"}
            </button>
            <button className="chip" onClick={clearChecked}>Clear checked</button>
            <button className="chip" onClick={reset}>Reset</button>
          </div>

          {Object.entries(groups).map(([cat, arr]) => (
            <section key={cat}>
              {cat !== "Other" && <h2>{cat}</h2>}
              <ul>
                {arr.map(i => (
                  <li key={i.id}>
                    <input type="checkbox" checked={i.checked} onChange={() => toggleItem(i.id)} />
                    <span className={"item-text " + (i.checked ? "done" : "")}>{i.text}</span>
                  </li>
                ))}
              </ul>
            </section>
          ))}

          <div className="footer">Tip: Open this page in Safari → Share → <b>Add to Home Screen</b> to install it like an app. Works offline via localStorage.</div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<App />);
  </script>
</body>
</html>
