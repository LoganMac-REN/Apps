:root{
  --bg: #fff7f7;
  --card: #ffffff;
  --text: #1b1b1f;
  --muted: #6b7280;
  --accent: #ef4444;
  --accent-600: #dc2626;
  --border: #ececec;
  --shadow: 0 8px 24px rgba(0,0,0,.08);
  --radius: 18px;
}

*{ box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
html, body { height: 100%; }
body{
  margin:0; background:var(--bg); color:var(--text);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
  line-height:1.25;
}

/* Top bar / tabs */
.topbar{
  position: sticky; top:0; z-index: 5;
  display:flex; align-items:center; justify-content:space-between;
  padding:12px 16px; background:var(--card); border-bottom:1px solid var(--border);
}
.brand{ font-weight:700; }
.tabs{ display:flex; gap:8px; }
.tab{
  border:1px solid var(--border); background:#fff; padding:8px 12px; border-radius:999px; font-weight:600;
}
.tab.active{ border-color:var(--accent); color:#fff; background:var(--accent); }

/* Page container */
.container{ max-width: 680px; margin: 10px auto 64px; padding: 0 14px; }
.page[hidden]{ display:none !important; }
h1{ font-size: 20px; margin: 10px 4px 12px; }

/* Add bars */
.addbar{
  display:grid; grid-template-columns: 1fr auto auto; gap:10px;
  background:var(--card); padding:10px; border-radius: var(--radius);
  box-shadow: var(--shadow); border:1px solid var(--border);
  margin-bottom: 12px;
}
.addbar input[type="text"], .addbar input[type="date"], .addbar input:not([type]){
  font-size:16px; padding:12px; border:1px solid var(--border); border-radius:12px; width:100%;
}
.qtywrap{
  display:flex; align-items:center; gap:6px; background:#fafafa; padding:6px; border:1px solid var(--border);
  border-radius:12px;
}
.qtywrap input{ width:56px; padding:10px; text-align:center; border:1px solid var(--border); border-radius:10px; }
.qtybtn{
  padding:8px 12px; border:1px solid var(--border); background:#fff; border-radius:10px; font-size:18px;
}

/* Date field styling */
.datewrap{
  display:flex; align-items:center; gap:6px;
  padding:0 8px; border:1px solid var(--border); border-radius:12px; background:#fafafa;
}
.datewrap .icon{ font-size:18px; }
.datewrap input[type="date"]{
  border:none; background:transparent; padding:10px 4px; font:inherit; min-width:130px; cursor:pointer;
}

/* Buttons */
button{ font:inherit; cursor:pointer; }
.primary{
  background:var(--accent); color:#fff; border:none; padding:12px 16px; border-radius:12px; font-weight:700;
}
.primary:active{ background:var(--accent-600); }
.danger{ border:1px solid #fca5a5; background:#fff; color:#b91c1c; padding:10px 14px; border-radius:12px; }

/* Lists */
.list{ list-style:none; padding:0; margin:0; display:flex; flex-direction:column; gap:10px; }
.item{
  display:grid; grid-template-columns: auto 1fr auto; gap:10px; align-items:center;
  background:var(--card); border:1px solid var(--border); border-radius: var(--radius); padding:12px;
  box-shadow: var(--shadow);
}
.item .name{ font-weight:600; line-height:1.2; }
.sub{ font-size:12px; color:var(--muted); display:flex; gap:8px; align-items:center; flex-wrap:wrap; }

.badge{
  font-size:12px; padding:4px 8px; border-radius:999px; border:1px solid var(--border); background:#fafafa;
}
.badge.due-today{ background:#fff1f2; border-color:#fecaca; }
.badge.due-soon{  background:#fff7ed; border-color:#fed7aa; }
.badge.due-overdue{ background:#fee2e2; border-color:#fca5a5; font-weight:700; }
.badge.due-none{ opacity:.7; }

.iconbtn{
  border:1px solid var(--border); background:#fff; border-radius:10px; padding:8px 10px;
}

/* Hidden shared date input */
.hidden-date{
  position:absolute; left:-9999px; width:0; height:0; opacity:0; pointer-events:none;
}

/* Footer actions */
.actions{ display:flex; gap:10px; justify-content:center; margin:14px 0 6px; }

/* Modal */
.modal{ position:fixed; inset:0; display:none; }
.modal.open{ display:block; }
.backdrop{ position:absolute; inset:0; background:rgba(0,0,0,.25); }
.sheet{
  position:absolute; left:50%; transform:translateX(-50%);
  bottom:0; width:min(700px, 100%); background:#fff; border-radius:20px 20px 0 0; box-shadow: var(--shadow);
  padding:10px; animation:slideUp .2s ease-out;
}
@keyframes slideUp{ from{ transform:translate(-50%, 12px); opacity:.9; } to{ transform:translate(-50%, 0); opacity:1; } }
.sheet-head{ display:flex; align-items:center; justify-content:space-between; padding:8px 6px 0; }
.sheet-body{ padding:8px 6px; }
.sheet-foot{ padding:8px 6px 12px; display:flex; justify-content:flex-end; }
textarea{
  width:100%; min-height:140px; padding:12px; border:1px solid var(--border); border-radius:12px; font:inherit;
}

/* iPhone safe area */
@supports(padding:max(0px)){
  .sheet{ padding-bottom: max(10px, env(safe-area-inset-bottom)); }
}
